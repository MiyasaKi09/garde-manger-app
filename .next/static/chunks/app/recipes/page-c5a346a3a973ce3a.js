(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[686],{9500:function(e,t,i){Promise.resolve().then(i.bind(i,6606))},6606:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return d}});var n=i(7437),s=i(2265),a=i(7138),r=i(6463),l=i(5626);function c(e){let{recipeId:t,portions:i,onSelectionChange:a}=e,[r,l]=(0,s.useState)([]),[c,o]=(0,s.useState)({}),[d,u]=(0,s.useState)(!0),[m,h]=(0,s.useState)(null);(0,s.useEffect)(()=>{t&&p()},[t]);let p=async()=>{u(!0),h(null);try{let e=await fetch("/api/recipes/".concat(t,"/available-ingredients")),i=await e.json();if(!e.ok)throw Error(i.error||"Erreur lors du chargement des ingr\xe9dients");l(i.ingredients||[]);let n={};i.ingredients.forEach(e=>{if(e.available_lots&&e.available_lots.length>0){let t=e.available_lots[0];n[e.ingredient_id]=[{lot_id:t.lot_id,product_name:t.product_name,quantity_to_use:Math.min(e.quantity_needed,t.quantity_available),unit:t.unit}]}}),o(n)}catch(e){console.error("Erreur chargement ingr\xe9dients:",e),h(e.message)}finally{u(!1)}};(0,s.useEffect)(()=>{a&&a(c)},[c]);let g=(e,t)=>{o(i=>{let n=i[e]||[];if(n.find(e=>e.lot_id===t.lot_id))return{...i,[e]:n.filter(e=>e.lot_id!==t.lot_id)};{let s=r.find(t=>t.ingredient_id===e);return{...i,[e]:[...n,{lot_id:t.lot_id,product_name:t.product_name,quantity_to_use:Math.min(s.quantity_needed,t.quantity_available),unit:t.unit}]}}})},v=(e,t,i)=>{o(n=>{let s=n[e]||[];return{...n,[e]:s.map(e=>e.lot_id===t?{...e,quantity_to_use:parseFloat(i)||0}:e)}})},x=(e,t)=>(c[e]||[]).some(e=>e.lot_id===t),j=e=>(c[e]||[]).reduce((e,t)=>e+t.quantity_to_use,0),b=e=>{let t=j(e.ingredient_id),i=e.quantity_needed;return 0===t?"❌":t<.9*i?"⚠️":t>=i?"✅":"\uD83D\uDD36"};return d?(0,n.jsxs)("div",{className:"ingredient-selector-loading",children:[(0,n.jsx)("div",{className:"spinner"}),(0,n.jsx)("p",{children:"Chargement des ingr\xe9dients disponibles..."})]}):m?(0,n.jsxs)("div",{className:"ingredient-selector-error",children:["⚠️ ",m]}):0===r.length?(0,n.jsx)("div",{className:"ingredient-selector-empty",children:"ℹ️ Aucun ingr\xe9dient trouv\xe9 pour cette recette"}):(0,n.jsxs)("div",{className:"ingredient-selector",children:[(0,n.jsxs)("div",{className:"selector-header",children:[(0,n.jsx)("h3",{children:"\uD83E\uDD55 Ingr\xe9dients n\xe9cessaires"}),(0,n.jsx)("p",{className:"hint",children:"S\xe9lectionnez les lots \xe0 utiliser pour chaque ingr\xe9dient"})]}),(0,n.jsx)("div",{className:"ingredients-list",children:r.map(e=>{let t=j(e.ingredient_id),i=e.quantity_needed,s=i>0?Math.min(100,t/i*100):0;return(0,n.jsxs)("div",{className:"ingredient-item",children:[(0,n.jsxs)("div",{className:"ingredient-header",children:[(0,n.jsxs)("div",{className:"ingredient-info",children:[(0,n.jsx)("span",{className:"status-icon",children:b(e)}),(0,n.jsx)("span",{className:"ingredient-name",children:e.name}),(0,n.jsxs)("span",{className:"quantity-badge",children:[e.quantity_needed," ",e.unit_needed]})]}),(0,n.jsx)("div",{className:"progress-bar",children:(0,n.jsx)("div",{className:"progress-fill",style:{width:"".concat(s,"%")}})})]}),0===e.available_lots.length?(0,n.jsx)("div",{className:"no-lots",children:"⚠️ Aucun lot disponible dans l'inventaire"}):(0,n.jsx)("div",{className:"lots-list",children:e.available_lots.map(t=>{var i;let s=x(e.ingredient_id,t.lot_id),a=null===(i=c[e.ingredient_id])||void 0===i?void 0:i.find(e=>e.lot_id===t.lot_id);return(0,n.jsxs)("div",{className:"lot-item ".concat(s?"selected":""),children:[(0,n.jsxs)("label",{className:"lot-checkbox",children:[(0,n.jsx)("input",{type:"checkbox",checked:s,onChange:()=>g(e.ingredient_id,t)}),(0,n.jsxs)("div",{className:"lot-details",children:[(0,n.jsx)("span",{className:"lot-name",children:t.product_name}),(0,n.jsxs)("span",{className:"lot-stock",children:["Stock: ",t.quantity_available," ",t.unit]}),null!==t.days_until_expiry&&(0,n.jsx)("span",{className:"lot-expiry ".concat(t.days_until_expiry<=3?"urgent":""),children:t.days_until_expiry<=0?"\uD83D\uDD34 Expir\xe9":t.days_until_expiry<=3?"\uD83D\uDFE0 ".concat(t.days_until_expiry,"j restants"):"\uD83D\uDFE2 ".concat(t.days_until_expiry,"j restants")})]})]}),s&&(0,n.jsxs)("div",{className:"quantity-input-group",children:[(0,n.jsx)("label",{children:"Utiliser:"}),(0,n.jsx)("input",{type:"number",min:"0",max:t.quantity_available,step:"0.1",value:(null==a?void 0:a.quantity_to_use)||0,onChange:i=>v(e.ingredient_id,t.lot_id,i.target.value),className:"quantity-input"}),(0,n.jsx)("span",{className:"unit-label",children:t.unit})]})]},t.lot_id)})}),(0,n.jsx)("div",{className:"ingredient-summary",children:(0,n.jsxs)("span",{className:t>=i?"sufficient":"insufficient",children:["S\xe9lectionn\xe9: ",t.toFixed(2)," / ",i," ",e.unit_needed]})})]},e.ingredient_id)})})]})}function o(e){let{recipe:t,onClose:i,onSuccess:a}=e,[r,l]=(0,s.useState)((null==t?void 0:t.servings)||4),[o,d]=(0,s.useState)("fridge"),[u,m]=(0,s.useState)(""),[h,p]=(0,s.useState)({}),[g,v]=(0,s.useState)(!1),[x,j]=(0,s.useState)(null),b=async e=>{e.preventDefault(),v(!0),j(null);try{let e=Object.entries(h).flatMap(e=>{let[t,i]=e;return i.map(e=>({ingredient_id:parseInt(t),lot_id:e.lot_id,quantity_used:e.quantity_to_use,unit:e.unit,product_name:e.product_name}))}),n=await fetch("/api/recipes/".concat(t.id,"/cook"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({portions:r,storageMethod:o,notes:u.trim()||null,ingredients:e})}),s=await n.json();if(!n.ok)throw Error(s.error||"Erreur lors de la cr\xe9ation du plat");a&&a(s.dish),i()}catch(e){console.error("Erreur:",e),j(e.message)}finally{v(!1)}},_=e=>{switch(e){case"fridge":return"❄️";case"freezer":return"\uD83E\uDDCA";case"counter":return"\uD83C\uDFE0";default:return"\uD83D\uDCE6"}},f=e=>{switch(e){case"fridge":return"Frigo (3 jours)";case"freezer":return"Cong\xe9lateur (90 jours)";case"counter":return"Comptoir (1 jour)";default:return e}};return t?(0,n.jsx)("div",{className:"dialog-overlay",onClick:i,children:(0,n.jsxs)("div",{className:"dialog-content",onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{className:"dialog-header",children:[(0,n.jsxs)("h2",{children:['\uD83C\uDF73 Cuisiner "',t.name,'"']}),(0,n.jsx)("button",{className:"close-btn",onClick:i,children:"✕"})]}),(0,n.jsxs)("form",{onSubmit:b,className:"cook-form",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"portions",children:"\uD83D\uDC65 Nombre de portions cuisin\xe9es"}),(0,n.jsxs)("div",{className:"portions-control",children:[(0,n.jsx)("button",{type:"button",className:"portions-btn",onClick:()=>l(Math.max(1,r-1)),disabled:r<=1,children:"−"}),(0,n.jsx)("input",{id:"portions",type:"number",min:"1",max:"99",value:r,onChange:e=>l(Math.max(1,parseInt(e.target.value)||1)),className:"portions-input"}),(0,n.jsx)("button",{type:"button",className:"portions-btn",onClick:()=>l(Math.min(99,r+1)),disabled:r>=99,children:"+"})]}),(0,n.jsxs)("small",{className:"hint",children:["Recette originale : ",t.servings," portions"]})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"\uD83D\uDCE6 Mode de stockage"}),(0,n.jsx)("div",{className:"storage-options",children:["fridge","freezer","counter"].map(e=>(0,n.jsxs)("button",{type:"button",className:"storage-btn ".concat(o===e?"active":""),onClick:()=>d(e),children:[(0,n.jsx)("span",{className:"storage-icon",children:_(e)}),(0,n.jsx)("span",{className:"storage-label",children:f(e)})]},e))})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"notes",children:"\uD83D\uDCDD Notes (optionnel)"}),(0,n.jsx)("textarea",{id:"notes",value:u,onChange:e=>m(e.target.value),placeholder:"Ex: Pr\xe9par\xe9 ce midi, avec des l\xe9gumes du jardin...",rows:"3",maxLength:"500",className:"notes-input"}),(0,n.jsxs)("small",{className:"hint",children:[u.length,"/500 caract\xe8res"]})]}),(0,n.jsx)("div",{className:"form-group",children:(0,n.jsx)(c,{recipeId:t.id,portions:r,onSelectionChange:p})}),x&&(0,n.jsxs)("div",{className:"error-message",children:["⚠️ ",x]}),(0,n.jsxs)("div",{className:"summary-box",children:[(0,n.jsx)("h3",{children:"\uD83D\uDCCB R\xe9sum\xe9"}),(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Plat :"})," ",t.name]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Portions :"})," ",r," portion",r>1?"s":""]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Stockage :"})," ",_(o)," ",f(o)]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"DLC :"})," "," ","fridge"===o&&"Dans 3 jours","freezer"===o&&"Dans 90 jours","counter"===o&&"Dans 1 jour"]})]})]}),(0,n.jsxs)("div",{className:"dialog-actions",children:[(0,n.jsx)("button",{type:"button",onClick:i,className:"btn-cancel",disabled:g,children:"Annuler"}),(0,n.jsx)("button",{type:"submit",className:"btn-submit",disabled:g,children:g?"⏳ Cr\xe9ation...":"✅ Ajouter au garde-manger"})]})]})]})}):null}function d(){let e=(0,r.useRouter)(),[t,i]=(0,s.useState)([]),[c,d]=(0,s.useState)([]),[u,m]=(0,s.useState)(!0),[h,p]=(0,s.useState)(""),[g,v]=(0,s.useState)("all"),[x,j]=(0,s.useState)("myko_score"),[b,_]=(0,s.useState)("desc"),[f,y]=(0,s.useState)({}),[N,D]=(0,s.useState)(null),[C,k]=(0,s.useState)(null);async function E(){try{m(!0),console.log("=== CHARGEMENT RECETTES ==="),console.log("URL Supabase:","https://yylkwfikfbottngglaxj.supabase.co"),console.log("Cl\xe9 d\xe9finie:",!0);let{data:e,error:t}=await l.OQ.from("recipes").select("*").order("id",{ascending:!1});if(console.log("R\xe9sultat requ\xeate Supabase:"),console.log("- Donn\xe9es:",e),console.log("- Erreur:",t),console.log("- Nombre de recettes:",(null==e?void 0:e.length)||0),t){console.error("ERREUR SUPABASE:",t),D("Erreur de connexion: ".concat(t.message)),i([]);return}if(e&&e.length>0){console.log("Structure de la premi\xe8re recette:"),console.log("Colonnes disponibles:",Object.keys(e[0])),console.log("Premi\xe8re recette compl\xe8te:",e[0]);let t=e.map(e=>e.id),{data:n,error:s}=await l.OQ.from("recipe_ingredients").select("\n            recipe_id,\n            id,\n            quantity,\n            unit,\n            notes,\n            canonical_food_id,\n            archetype_id,\n            canonical_foods (\n              id,\n              canonical_name,\n              category_id,\n              primary_unit\n            ),\n            archetypes (\n              id,\n              name,\n              canonical_food_id,\n              process,\n              primary_unit\n            )\n          ").in("recipe_id",t);s&&console.error("Erreur chargement ingr\xe9dients:",s);let a={};n&&n.forEach(e=>{a[e.recipe_id]||(a[e.recipe_id]=[]),a[e.recipe_id].push(e)});let r=e.map(e=>{var t;return{...e,recipe_ingredients:a[e.id]||[],title:e.name,prep_min:e.prep_time_minutes,cook_min:e.cook_time_minutes,portions:e.servings,myko_score:Math.min(100,50+5*((null===(t=a[e.id])||void 0===t?void 0:t.length)||0))}});console.log("Recettes enrichies avec ingr\xe9dients:",r.length),i(r);return}console.log("Aucune recette trouv\xe9e, test de la table...");let{data:n,error:s}=await l.OQ.from("recipes").select("id").limit(1);s?(console.error("Table recipes introuvable:",s),D("Table 'recipes' introuvable. Veuillez v\xe9rifier votre base de donn\xe9es.")):(console.log("Table recipes existe mais est vide"),i([]))}catch(e){console.error("Erreur lors du chargement des recettes:",e),D("Erreur: ".concat(e.message)),i([])}finally{m(!1)}}async function S(){try{var e,i;if(0===t.length)return;console.log("\uD83D\uDD0D V\xe9rification disponibilit\xe9 pour",t.length,"recettes"),console.log("\uD83D\uDCCB Premi\xe8re recette:",t[0]),console.log("\uD83E\uDD55 Ingr\xe9dients premi\xe8re recette:",(null===(i=t[0])||void 0===i?void 0:null===(e=i.recipe_ingredients)||void 0===e?void 0:e.length)||0);let{data:n,error:s}=await l.OQ.from("inventory_lots").select("canonical_food_id, archetype_id, quantity_remaining").gt("quantity_remaining",0).gt("expiry_date",new Date().toISOString());if(s){console.error("Erreur chargement inventaire:",s);return}let a=new Set(n.filter(e=>e.canonical_food_id).map(e=>e.canonical_food_id)),r=new Set(n.filter(e=>e.archetype_id).map(e=>e.archetype_id)),c={};for(let e of t){let t=e.recipe_ingredients||[],i=t.length;if(0===i){c[e.id]={totalIngredients:0,availableIngredients:0,availabilityPercent:0,urgentIngredients:0};continue}let n=0;t.forEach(e=>{let t=e.canonical_food_id&&a.has(e.canonical_food_id),i=e.archetype_id&&r.has(e.archetype_id);(t||i)&&n++});let s=i-n;c[e.id]={totalIngredients:i,availableIngredients:n,availabilityPercent:Math.round(n/i*100),urgentIngredients:s},(142===e.id||2===e.id)&&console.log("\uD83D\uDCCA Recette #".concat(e.id,":"),{total:i,available:n,percent:Math.round(n/i*100)})}console.log("✅ Statuts calcul\xe9s pour",Object.keys(c).length,"recettes"),y(c)}catch(e){console.error("Erreur v\xe9rification stocks:",e)}}(0,s.useEffect)(()=>{l.OQ.auth.getUser().then(t=>{let{data:{user:i}}=t;i||e.push("/login")})},[e]),(0,s.useEffect)(()=>{E()},[]),(0,s.useEffect)(()=>{t.length>0&&S()},[t]),(0,s.useEffect)(()=>{let e;e=[...t],h&&(e=e.filter(e=>(e.title||e.name||"").toLowerCase().includes(h.toLowerCase())||e.description&&e.description.toLowerCase().includes(h.toLowerCase()))),"all"!==g&&(e=e.filter(e=>{let t=f[e.id]||{availabilityPercent:0,urgentIngredients:0};return"available"===g?t.availabilityPercent>80:"partial"===g?t.availabilityPercent>30&&t.availabilityPercent<=80:"urgent"!==g||t.urgentIngredients>0})),e.sort((e,t)=>{let i,n;switch(x){case"myko_score":i=e.myko_score||0,n=t.myko_score||0;break;case"availability":var s,a;i=(null===(s=f[e.id])||void 0===s?void 0:s.availabilityPercent)||0,n=(null===(a=f[t.id])||void 0===a?void 0:a.availabilityPercent)||0;break;case"time":i=(e.prep_min||0)+(e.cook_min||0)+(e.rest_min||0),n=(t.prep_min||0)+(t.cook_min||0)+(t.rest_min||0);break;case"name":let r=e.title||e.name||"",l=t.title||t.name||"";return"asc"===b?r.localeCompare(l):l.localeCompare(r);default:i=e.id||0,n=t.id||0}return"asc"===b?i-n:n-i}),d(e)},[t,h,g,x,b,f]);let P=t.length,I=c.filter(e=>(f[e.id]||{availabilityPercent:0}).availabilityPercent>80).length,w=c.filter(e=>{let t=f[e.id]||{availabilityPercent:0};return t.availabilityPercent>30&&t.availabilityPercent<=80}).length,q=c.filter(e=>(f[e.id]||{urgentIngredients:0}).urgentIngredients>0).length;return u?(0,n.jsx)("div",{className:"recipes-container",children:(0,n.jsx)("div",{className:"loading-spinner",children:"Chargement des recettes Myko..."})}):N?(0,n.jsx)("div",{className:"recipes-container",children:(0,n.jsxs)("div",{className:"error-message",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"12px",padding:"20px",textAlign:"center"},children:[(0,n.jsx)("h2",{style:{color:"#dc2626"},children:"Erreur de connexion"}),(0,n.jsx)("p",{children:N}),(0,n.jsx)("button",{onClick:()=>{D(null),E()},style:{padding:"10px 20px",background:"#dc2626",color:"white",border:"none",borderRadius:"8px",cursor:"pointer"},children:"R\xe9essayer"})]})}):(0,n.jsxs)("div",{className:"recipes-container",children:[(0,n.jsxs)("div",{className:"recipes-controls",children:[(0,n.jsxs)("div",{className:"search-filters",children:[(0,n.jsx)("input",{type:"text",placeholder:"Rechercher une recette...",value:h,onChange:e=>p(e.target.value),className:"search-input"}),(0,n.jsxs)("select",{value:g,onChange:e=>v(e.target.value),className:"filter-select",children:[(0,n.jsx)("option",{value:"all",children:"Toutes les recettes"}),(0,n.jsx)("option",{value:"available",children:"R\xe9alisables"}),(0,n.jsx)("option",{value:"partial",children:"Partielles"}),(0,n.jsx)("option",{value:"urgent",children:"Urgentes"})]}),(0,n.jsx)(a.default,{href:"/recipes/edit/new",className:"add-recipe-btn",children:"+ Nouvelle recette"})]}),(0,n.jsxs)("div",{className:"stats-controls",children:[(0,n.jsxs)("div",{className:"stats-inline",children:[(0,n.jsxs)("div",{className:"stat-item stat-filter-btn ".concat("all"===g?"stat-filter-active":""),onClick:()=>v("all"),children:[(0,n.jsx)("div",{className:"stat-number",children:P}),(0,n.jsx)("div",{className:"stat-label",children:"Total"})]}),(0,n.jsxs)("div",{className:"stat-item stat-filter-btn ".concat("available"===g?"stat-filter-active":""),onClick:()=>v("available"),children:[(0,n.jsx)("div",{className:"stat-number",children:I}),(0,n.jsx)("div",{className:"stat-label",children:"R\xe9alisables"})]}),(0,n.jsxs)("div",{className:"stat-item stat-filter-btn ".concat("partial"===g?"stat-filter-active":""),onClick:()=>v("partial"),children:[(0,n.jsx)("div",{className:"stat-number",children:w}),(0,n.jsx)("div",{className:"stat-label",children:"Partielles"})]}),(0,n.jsxs)("div",{className:"stat-item stat-filter-btn urgent-recipes ".concat("urgent"===g?"stat-filter-active":""),onClick:()=>v("urgent"),children:[(0,n.jsx)("div",{className:"stat-number",children:q}),(0,n.jsx)("div",{className:"stat-label",children:"Urgentes"})]})]}),(0,n.jsxs)("div",{className:"sort-controls",children:[(0,n.jsxs)("button",{className:"sort-btn ".concat("myko_score"===x?"active":""),onClick:()=>{"myko_score"===x?_("desc"===b?"asc":"desc"):(j("myko_score"),_("desc"))},children:["Score Myko ","myko_score"===x&&("desc"===b?"↓":"↑")]}),(0,n.jsxs)("button",{className:"sort-btn ".concat("availability"===x?"active":""),onClick:()=>{"availability"===x?_("desc"===b?"asc":"desc"):(j("availability"),_("desc"))},children:["Disponibilit\xe9 ","availability"===x&&("desc"===b?"↓":"↑")]}),(0,n.jsxs)("button",{className:"sort-btn ".concat("time"===x?"active":""),onClick:()=>{"time"===x?_("asc"===b?"desc":"asc"):(j("time"),_("asc"))},children:["Temps ","time"===x&&("asc"===b?"↑":"↓")]}),(0,n.jsxs)("button",{className:"sort-btn ".concat("name"===x?"active":""),onClick:()=>{"name"===x?_("asc"===b?"desc":"asc"):(j("name"),_("asc"))},children:["Nom ","name"===x&&("asc"===b?"↑":"↓")]})]}),c.length!==P&&(0,n.jsxs)("div",{className:"filter-count",children:[c.length," sur ",P," recettes"]})]})]}),(0,n.jsx)("div",{className:"recipes-grid",children:0===c.length?(0,n.jsxs)("div",{className:"empty-state",children:[(0,n.jsx)("h2",{children:"Aucune recette trouv\xe9e"}),(0,n.jsx)("p",{children:"Essayez de modifier vos filtres ou ajoutez de nouvelles recettes."}),(0,n.jsx)(a.default,{href:"/recipes/edit/new",className:"add-recipe-btn",children:"Cr\xe9er une nouvelle recette"})]}):c.map(e=>{var t;let i=f[e.id]||{totalIngredients:0,availableIngredients:0,availabilityPercent:0,urgentIngredients:0},s=i.urgentIngredients>0;return(0,n.jsxs)(a.default,{href:"/recipes/".concat(e.id),className:"recipe-card ".concat(s?"urgent-recipe":""),style:{textDecoration:"none",color:"inherit",cursor:"pointer"},children:[(0,n.jsxs)("div",{className:"recipe-header",children:[(0,n.jsx)("h3",{className:"recipe-title",children:e.title||e.name}),(0,n.jsx)("div",{className:"recipe-badges",children:s&&(0,n.jsx)("div",{className:"urgent-badge",children:"URGENT"})})]}),e.description&&(0,n.jsx)("p",{className:"recipe-description",children:e.description}),(0,n.jsxs)("div",{className:"recipe-meta",children:[(0,n.jsxs)("div",{className:"meta-item",children:[(0,n.jsx)("span",{className:"meta-icon",children:"⏱️"}),(0,n.jsx)("span",{children:(e.prep_min||0)+(e.cook_min||0)+(e.rest_min||0)>0?"".concat((e.prep_min||0)+(e.cook_min||0)+(e.rest_min||0)," min"):"Temps non d\xe9fini"})]}),(0,n.jsxs)("div",{className:"meta-item",children:[(0,n.jsx)("span",{className:"meta-icon",children:"\uD83D\uDC65"}),(0,n.jsxs)("span",{children:[e.servings||e.portions||"Non d\xe9fini"," parts"]})]}),(0,n.jsxs)("div",{className:"meta-item",children:[(0,n.jsx)("span",{className:"meta-icon",children:"\uD83D\uDCCA"}),(0,n.jsx)("span",{children:(null===(t=e.difficulty_levels)||void 0===t?void 0:t.name)||e.difficulty||"Non d\xe9fini"})]})]}),(0,n.jsxs)("div",{className:"recipe-availability",children:[(0,n.jsx)("div",{className:"availability-bar",children:(0,n.jsx)("div",{className:"availability-fill",style:{width:"".concat(i.availabilityPercent,"%")}})}),(0,n.jsxs)("div",{className:"availability-text",children:[i.availabilityPercent,"% disponible (",i.availableIngredients,"/",i.totalIngredients,")"]})]}),(0,n.jsxs)("div",{className:"recipe-actions",children:[(0,n.jsx)("button",{className:"action-btn primary",onClick:e=>{},children:"\uD83D\uDC41️ Voir"}),(0,n.jsx)("button",{className:"action-btn cook",onClick:t=>{t.preventDefault(),t.stopPropagation(),k(e)},children:"\uD83C\uDF73 Cuisiner"}),(0,n.jsx)("button",{className:"action-btn secondary",onClick:t=>{t.preventDefault(),t.stopPropagation(),alert('\uD83C\uDF3F "'.concat(e.name,'" ajout\xe9e au planning !'))},children:"\uD83D\uDCC5 Planifier"}),(0,n.jsx)("button",{className:"action-btn tertiary",onClick:e=>{e.preventDefault(),e.stopPropagation(),alert("\uD83D\uDED2 Ingr\xe9dients manquants ajout\xe9s aux courses !")},children:"\uD83D\uDED2 Courses"})]})]},e.id)})}),C&&(0,n.jsx)(o,{recipe:C,onClose:()=>k(null),onSuccess:e=>{alert('✅ "'.concat(e.name,'" ajout\xe9 au garde-manger avec ').concat(e.portions_remaining," portions !")),k(null)}})]})}i(5977),i(2550),i(5213)},5626:function(e,t,i){"use strict";i.d(t,{OQ:function(){return r}});var n=i(6887);let s="https://yylkwfikfbottngglaxj.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl5bGt3ZmlrZmJvdHRuZ2dsYXhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY1NjUwNzAsImV4cCI6MjA3MjE0MTA3MH0.h-GTmBH9onVHNJLLuafw9jwS9G8azVaQGelf-oUK-xc",r=null;if(s&&a)try{console.log("\uD83D\uDD17 Connexion \xe0 Supabase r\xe9el:",s),r=(0,n.eI)(s,a,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})}catch(e){console.error("[Supabase] Erreur lors de la cr\xe9ation du client",e instanceof Error?e:Error(String(e)))}else{let e=[!s&&"NEXT_PUBLIC_SUPABASE_URL",!a&&"NEXT_PUBLIC_SUPABASE_ANON_KEY"].filter(Boolean);Error("Supabase non configur\xe9. Variables manquantes: ".concat(e.join(", ")))}},6463:function(e,t,i){"use strict";var n=i(1169);i.o(n,"useParams")&&i.d(t,{useParams:function(){return n.useParams}}),i.o(n,"usePathname")&&i.d(t,{usePathname:function(){return n.usePathname}}),i.o(n,"useRouter")&&i.d(t,{useRouter:function(){return n.useRouter}}),i.o(n,"useSearchParams")&&i.d(t,{useSearchParams:function(){return n.useSearchParams}})},5213:function(){},2550:function(){},5977:function(){}},function(e){e.O(0,[738,887,138,971,23,744],function(){return e(e.s=9500)}),_N_E=e.O()}]);