Résumé de la Logique Complète du Système
1. Le Lexique Alimentaire (La Hiérarchie Fondamentale)
C'est le dictionnaire de tous les aliments, organisé en quatre niveaux de précision.

canonical_foods : Le concept brut (Tomate, Blé, Lait). C'est la base pour les données nutritionnelles générales. La plupart des fruits et légumes frais y sont classés.

cultivars : La variété biologique (Tomate 'Marmande'). Pour les produits du jardin ou les recettes exigeant une variété précise.

archetypes : La forme transformée, sans marque (Farine de blé, Tomates concassées en conserve). C'est le niveau le plus utilisé dans les recettes.

products : L'article commercial, avec marque et emballage (Lait UHT 50cl Lactel). Utilisé uniquement pour l'inventaire, jamais dans les recettes.

2. La Recette Intelligente (Le "Comment Faire")
Une recette est un objet de données structuré et dynamique.

Structure de base : recipes (nom, temps), recipe_ingredients (lie la recette à un archetype, cultivar ou canonical_food), instructions (étapes ordonnées).

Classification : recipe_tags et tags permettent de classifier les recettes ("Rapide", "Végétarien").

Associations classiques : recipe_pairings stocke les associations traditionnelles entre plats (ex: plat principal et accompagnement).

3. La Gestion d'Inventaire (Ce que vous possédez)
Le miroir numérique de votre cuisine.

inventory_lots : Table centrale flexible. Chaque entrée est un lot unique lié à un canonical_food, cultivar, archetype ou product, avec sa propre quantité et date de péremption pour une gestion anti-gaspillage précise.

4. L'Utilisateur et la Personnalisation (Le Cœur de l'Intelligence)
Le système apprend de vous pour mieux vous servir.

users : Identifie chaque utilisateur.

user_recipe_interactions : Enregistre vos actions (notes, favoris) pour comprendre vos goûts.

meal_plans & planned_meals : Organisateurs de vos menus hebdomadaires.

5. L'Intelligence Nutritionnelle (Le Calcul Précis)
Pour aller au-delà de la simple somme des calories des ingrédients bruts, le système applique une logique de correction scientifique pour estimer la valeur nutritionnelle du plat cuit.   

Données de base : Le système part des valeurs nutritionnelles des ingrédients crus, stockées dans nutritional_data (sourcées depuis des bases de données de référence comme CIQUAL).   

Facteurs de Rendement (Yield Factors) : La cuisson modifie le poids des aliments (perte ou gain d'eau). Le système utilise la table cooking_nutrition_factors pour appliquer un facteur de rendement qui ajuste le poids final du plat. C'est essentiel pour calculer les valeurs nutritionnelles pour 100g de plat cuit.   

Facteurs de Rétention (Retention Factors) : La chaleur détruit une partie des nutriments, notamment les vitamines. La table cooking_nutrition_factors contient également des facteurs de rétention qui permettent de réduire la quantité de certains nutriments en fonction de la méthode de cuisson, pour un calcul final plus réaliste.   

6. L'Intelligence d'Assemblage (L'Art des Saveurs)
Pour suggérer des associations pertinentes et créatives, le système combine deux approches.

Assemblage Classique : La table recipe_pairings stocke des associations validées par l'usage et la tradition (ex: "un plat en sauce s'accorde avec du riz"). C'est la base des recommandations fiables.

Assemblage par "Food Pairing" (Intelligence des Saveurs) : Pour créer des associations innovantes, le système s'appuie sur la gastronomie moléculaire.

Analyse Moléculaire : Le système se base sur un "réseau de saveurs", une base de données qui relie les ingrédients à leurs composés aromatiques principaux. Il recherche des ingrédients qui, bien que différents, partagent des molécules aromatiques clés.

Filtrage par Règles Culinaires : Les candidats issus de l'analyse moléculaire sont ensuite filtrés par des règles culinaires classiques pour garantir l'harmonie du plat final :

Équilibre : Un plat gras sera associé à un ingrédient acide (le "vinaigre").

Contraste : Un plat à la texture molle sera associé à un ingrédient croquant.

Intensité : Un plat "riche" sera associé à un accompagnement plus léger pour ne pas saturer le palais.