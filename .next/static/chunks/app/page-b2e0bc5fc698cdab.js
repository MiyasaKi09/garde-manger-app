(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5482:function(e,r,t){Promise.resolve().then(t.bind(t,2590))},2590:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return g}});var n=t(7437),s=t(2265),a=t(7138),i=t(5626);let o=()=>new Date().toISOString().slice(0,10),l=e=>e?Math.ceil((new Date(e)-new Date)/864e5):null,c={background:"rgba(255,255,255,0.55)",backdropFilter:"blur(10px) saturate(120%)",WebkitBackdropFilter:"blur(10px) saturate(120%)",border:"1px solid rgba(0,0,0,0.06)",boxShadow:"0 8px 28px rgba(0,0,0,0.08)",color:"var(--ink, #1f281f)"};function d(e){let{icon:r,value:t,label:a,color:i,trend:o}=e,[l,d]=(0,s.useState)(!1);return(0,n.jsxs)("div",{className:"glass-card",onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),style:{...c,borderRadius:"var(--radius-lg)",padding:"1.25rem",textAlign:"center",transition:"transform var(--transition-base), box-shadow var(--transition-base), background var(--transition-base), border-color var(--transition-base)",transform:l?"translateY(-2px)":"none",boxShadow:l?"0 12px 34px rgba(0,0,0,0.12)":c.boxShadow},children:[(0,n.jsx)("div",{style:{fontSize:"2rem",marginBottom:".25rem"},children:r}),(0,n.jsx)("div",{style:{fontSize:"2rem",fontWeight:700,color:i,lineHeight:1},children:t}),(0,n.jsx)("div",{style:{fontSize:".9rem",color:"var(--earth-600)"},children:a}),"number"==typeof o&&(0,n.jsxs)("div",{style:{fontSize:".8rem",color:o>0?"var(--success)":"var(--danger)",marginTop:".5rem",fontWeight:600},children:[o>0?"↑":"↓"," ",Math.abs(o),"% cette semaine"]})]})}function u(e){let{icon:r,title:t,description:i,href:o,color:l="var(--forest-500)"}=e,[d,u]=(0,s.useState)(!1);return(0,n.jsx)(a.default,{href:o,style:{textDecoration:"none"},children:(0,n.jsxs)("div",{onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),className:"glass-card",style:{...c,borderRadius:"var(--radius-lg)",padding:"1.25rem",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:".6rem",transition:"transform var(--transition-base), box-shadow var(--transition-base), border-color var(--transition-base)",transform:d?"translateY(-2px)":"none",boxShadow:d?"0 12px 34px rgba(0,0,0,0.12)":c.boxShadow,borderColor:d?"rgba(0,0,0,0.10)":c.borderColor},children:[(0,n.jsx)("div",{style:{fontSize:"2.2rem",transform:d?"scale(1.05) rotate(3deg)":"scale(1)",transition:"transform var(--transition-slow)"},children:r}),(0,n.jsx)("h3",{style:{margin:0,color:"var(--forest-700)",fontSize:"1.05rem"},children:t}),i&&(0,n.jsx)("p",{style:{margin:0,color:"var(--earth-600)",fontSize:".86rem",opacity:.9},children:i})]})})}function m(e){var r,t;let{item:s,type:a="expiring"}=e,i=l(s.dlc||s.best_before),o="expired"===a||i<0?{color:"var(--danger)",label:"P\xe9rim\xe9",icon:"\uD83C\uDF42"}:0===i?{color:"var(--autumn-orange)",label:"Aujourd'hui",icon:"⚡"}:i<=3?{color:"var(--autumn-yellow)",label:"".concat(i,"j"),icon:"⏰"}:i<=7?{color:"var(--forest-500)",label:"".concat(i,"j"),icon:"\uD83D\uDCC5"}:{color:"var(--success)",label:"".concat(i,"j"),icon:"\uD83C\uDF3F"};return(0,n.jsxs)("div",{className:"glass-card",style:{...c,borderRadius:"var(--radius-md)",padding:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",borderLeft:"4px solid ".concat(function(e){try{let r=e.replace("var(","").replace(")","").trim();return getComputedStyle(document.documentElement).getPropertyValue(r)||e}catch(r){return e}}(o.color))},children:[(0,n.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,n.jsx)("div",{style:{fontWeight:600,color:"var(--forest-700)",marginBottom:".25rem"},children:(null===(r=s.product)||void 0===r?void 0:r.name)||"Produit"}),(0,n.jsxs)("div",{style:{fontSize:".9rem",color:"var(--earth-600)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[s.qty," ",s.unit,(null===(t=s.location)||void 0===t?void 0:t.name)&&(0,n.jsxs)("span",{style:{marginLeft:".5rem",color:"var(--earth-500)"},children:["\uD83D\uDCCD ",s.location.name]})]})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:".5rem",padding:".4rem .8rem",background:"rgba(255,255,255,0.7)",border:"1px solid rgba(0,0,0,0.06)",borderRadius:"var(--radius-full)",color:o.color,fontWeight:600,fontSize:".9rem"},children:[(0,n.jsx)("span",{children:o.icon}),(0,n.jsx)("span",{children:o.label})]})]})}function h(e){var r;let{user:t}=e,[i,o]=(0,s.useState)("");return(0,s.useEffect)(()=>{let e=new Date().getHours();e<12?o("Bonjour"):e<18?o("Bon apr\xe8s-midi"):o("Bonsoir")},[]),(0,n.jsxs)("section",{className:"glass-card",style:{...c,borderRadius:"var(--radius-xl)",padding:"2rem",marginBottom:"2rem"},children:[(0,n.jsxs)("h1",{style:{fontSize:"clamp(2.2rem, 5vw, 3.2rem)",marginBottom:".5rem"},children:[i,t?", ".concat(null===(r=t.email)||void 0===r?void 0:r.split("@")[0]):""," \uD83C\uDF3F"]}),(0,n.jsxs)("p",{style:{fontSize:"1.1rem",color:"var(--earth-700)",marginBottom:t?"0":"1.25rem",maxWidth:700},children:["Bienvenue dans ",(0,n.jsx)("strong",{children:"Myko"}),", votre r\xe9seau mycorhizien qui connecte",(0,n.jsx)("span",{style:{color:"var(--forest-600)",fontWeight:600},children:" garde-manger"}),",",(0,n.jsx)("span",{style:{color:"var(--autumn-orange)",fontWeight:600},children:" recettes"})," et",(0,n.jsx)("span",{style:{color:"var(--earth-700)",fontWeight:600},children:" potager"}),"."]}),!t&&(0,n.jsxs)("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap"},children:[(0,n.jsx)(a.default,{href:"/login",className:"btn primary",style:{fontSize:"1.05rem",padding:".7rem 1.6rem"},children:"Se connecter"}),(0,n.jsx)(a.default,{href:"/recipes",className:"btn secondary",style:{fontSize:"1.05rem",padding:".7rem 1.6rem"},children:"Explorer les recettes"})]})]})}function g(){let[e,r]=(0,s.useState)(null),[t,g]=(0,s.useState)(!0),[v,f]=(0,s.useState)({lots:[],recipes:[],tasks:[],plantings:[],harvests:[]});(0,s.useEffect)(()=>{let e=!0;i.OQ.auth.getSession().then(t=>{var n;let{data:s}=t;e&&r((null==s?void 0:null===(n=s.session)||void 0===n?void 0:n.user)||null)});let{data:t}=i.OQ.auth.onAuthStateChange((t,n)=>{e&&r((null==n?void 0:n.user)||null)});return()=>{var r;e=!1,null==t||null===(r=t.subscription)||void 0===r||r.unsubscribe()}},[]),(0,s.useEffect)(()=>{if(!e){g(!1);return}(async function(){try{let e=o(),[r,t,n,s,a]=await Promise.all([i.OQ.from("inventory_lots").select("*, product:products_catalog(name), location:locations(name)").order("dlc",{ascending:!0}).limit(20),i.OQ.from("recipes").select("*").limit(10),i.OQ.from("care_tasks").select("*, planting:plantings(*, variety:plant_varieties(*))").is("done_at",null).lte("due_date",e).limit(10),i.OQ.from("plantings").select("*, variety:plant_varieties(*), bed:garden_beds(name)").eq("status","en_cours").limit(10),i.OQ.from("harvests").select("*, planting:plantings(variety:plant_varieties(*))").order("date",{ascending:!1}).limit(5)]);f({lots:r.data||[],recipes:t.data||[],tasks:n.data||[],plantings:s.data||[],harvests:a.data||[]})}catch(e){console.error("Error loading data:",e)}finally{g(!1)}})()},[e]);let x=(0,s.useMemo)(()=>{let e=v.lots.filter(e=>0>l(e.dlc)).length,r=v.lots.filter(e=>{let r=l(e.dlc);return null!==r&&r>=0&&r<=7}).length,t=v.lots.length;return{expired:e,expiring:r,totalLots:t,activePlants:v.plantings.length,pendingTasks:v.tasks.length,totalRecipes:v.recipes.length}},[v]),p=(0,s.useMemo)(()=>v.lots.filter(e=>{let r=l(e.dlc);return null!==r&&r<=3}).slice(0,5),[v.lots]);return(0,n.jsxs)("div",{className:"container",style:{position:"relative",zIndex:1},children:[(0,n.jsx)(h,{user:e}),e&&!t&&(0,n.jsxs)("section",{style:{marginBottom:"2rem"},children:[(0,n.jsx)("h2",{style:{marginBottom:"1rem"},children:"\uD83D\uDCCA Vue d'ensemble"}),(0,n.jsxs)("div",{className:"grid cols-4",children:[(0,n.jsx)(d,{icon:"\uD83C\uDFFA",value:x.totalLots,label:"Lots en stock",color:"var(--forest-600)",trend:5}),(0,n.jsx)(d,{icon:"⚠️",value:x.expiring,label:"\xc0 consommer",color:"var(--autumn-orange)",trend:-10}),(0,n.jsx)(d,{icon:"\uD83C\uDF31",value:x.activePlants,label:"Plantations actives",color:"var(--earth-700)",trend:15}),(0,n.jsx)(d,{icon:"\uD83D\uDCD6",value:x.totalRecipes,label:"Recettes disponibles",color:"var(--mushroom)"})]})]}),(0,n.jsxs)("section",{style:{marginBottom:"2rem"},children:[(0,n.jsx)("h2",{style:{marginBottom:"1rem"},children:"⚡ Actions rapides"}),(0,n.jsxs)("div",{className:"grid cols-4",children:[(0,n.jsx)(u,{icon:"➕",title:"Ajouter un lot",description:"Nouveau produit",href:"/pantry",color:"var(--forest-500)"}),(0,n.jsx)(u,{icon:"\uD83E\uDD58",title:"Cuisiner",description:"Lancer une recette",href:"/recipes",color:"var(--autumn-orange)"}),(0,n.jsx)(u,{icon:"\uD83C\uDF31",title:"Planter",description:"Nouveau semis",href:"/garden",color:"var(--earth-600)"}),(0,n.jsx)(u,{icon:"\uD83D\uDCC5",title:"Planning",description:"Voir les t\xe2ches",href:"/planning",color:"var(--mushroom)"})]})]}),e&&p.length>0&&(0,n.jsxs)("section",{style:{marginBottom:"2rem"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,n.jsx)("h2",{style:{margin:0},children:"\uD83D\uDD14 Produits \xe0 consommer rapidement"}),(0,n.jsx)(a.default,{href:"/pantry",className:"btn secondary small",children:"Voir tout →"})]}),(0,n.jsx)("div",{className:"grid cols-2",children:p.map(e=>(0,n.jsx)(m,{item:e},e.id))})]}),(0,n.jsxs)("section",{className:"glass-card",style:{...c,borderRadius:"var(--radius-xl)",padding:"2rem",marginBottom:"2rem",textAlign:"center"},children:[(0,n.jsx)("h2",{style:{marginBottom:".75rem"},children:"\uD83C\uDF44 Le R\xe9seau Mycorhizien"}),(0,n.jsx)("p",{style:{maxWidth:700,margin:"0 auto 1.25rem",color:"var(--earth-700)"},children:"Comme les champignons connectent les arbres dans la for\xeat, Myko relie vos aliments, recettes et cultures pour cr\xe9er un \xe9cosyst\xe8me alimentaire harmonieux et durable."}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:"2rem",flexWrap:"wrap"},children:[(0,n.jsxs)("div",{style:{textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontSize:"2.4rem",marginBottom:".25rem"},children:"\uD83C\uDFFA"}),(0,n.jsx)("div",{style:{fontWeight:600,color:"var(--forest-700)"},children:"Garde-manger"}),(0,n.jsx)("div",{style:{fontSize:".85rem",color:"var(--earth-700)"},children:"G\xe9rez vos stocks"})]}),(0,n.jsx)("div",{style:{fontSize:"1.6rem",alignSelf:"center",color:"var(--mushroom)"},children:"↔️"}),(0,n.jsxs)("div",{style:{textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontSize:"2.4rem",marginBottom:".25rem"},children:"\uD83D\uDCD6"}),(0,n.jsx)("div",{style:{fontWeight:600,color:"var(--forest-700)"},children:"Recettes"}),(0,n.jsx)("div",{style:{fontSize:".85rem",color:"var(--earth-700)"},children:"Cuisinez malin"})]}),(0,n.jsx)("div",{style:{fontSize:"1.6rem",alignSelf:"center",color:"var(--mushroom)"},children:"↔️"}),(0,n.jsxs)("div",{style:{textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontSize:"2.4rem",marginBottom:".25rem"},children:"\uD83C\uDF31"}),(0,n.jsx)("div",{style:{fontWeight:600,color:"var(--forest-700)"},children:"Potager"}),(0,n.jsx)("div",{style:{fontSize:".85rem",color:"var(--earth-700)"},children:"Cultivez local"})]})]})]}),!e&&(0,n.jsxs)("section",{className:"glass-card",style:{...c,borderRadius:"var(--radius-xl)",padding:"2rem",textAlign:"center"},children:[(0,n.jsx)("h2",{style:{marginBottom:".75rem"},children:"\uD83C\uDF3F Rejoignez le r\xe9seau"}),(0,n.jsx)("p",{style:{maxWidth:560,margin:"0 auto 1.25rem",color:"var(--earth-700)"},children:"Connectez-vous pour acc\xe9der \xe0 toutes les fonctionnalit\xe9s et commencer \xe0 g\xe9rer votre \xe9cosyst\xe8me alimentaire de mani\xe8re intelligente et durable."}),(0,n.jsx)(a.default,{href:"/login",className:"btn primary",style:{fontSize:"1.05rem",padding:".7rem 1.6rem"},children:"Commencer maintenant →"})]})]})}},5626:function(e,r,t){"use strict";t.d(r,{OQ:function(){return i}});var n=t(6887);let s="https://yylkwfikfbottngglaxj.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl5bGt3ZmlrZmJvdHRuZ2dsYXhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY1NjUwNzAsImV4cCI6MjA3MjE0MTA3MH0.h-GTmBH9onVHNJLLuafw9jwS9G8azVaQGelf-oUK-xc",i=null;if(s&&a)try{console.log("\uD83D\uDD17 Connexion \xe0 Supabase r\xe9el:",s),i=(0,n.eI)(s,a,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})}catch(e){console.error("[Supabase] Erreur lors de la cr\xe9ation du client",e instanceof Error?e:Error(String(e)))}else{let e=[!s&&"NEXT_PUBLIC_SUPABASE_URL",!a&&"NEXT_PUBLIC_SUPABASE_ANON_KEY"].filter(Boolean);Error("Supabase non configur\xe9. Variables manquantes: ".concat(e.join(", ")))}}},function(e){e.O(0,[887,138,971,23,744],function(){return e(e.s=5482)}),_N_E=e.O()}]);