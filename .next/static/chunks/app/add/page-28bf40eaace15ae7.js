(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[853],{1426:function(e,t,n){Promise.resolve().then(n.bind(n,6970))},6970:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var i=n(7437),l=n(2265),a=n(5626);function o(){let[e,t]=(0,l.useState)([]),[n,o]=(0,l.useState)([]),[r,s]=(0,l.useState)({product_id:"",location_id:"",qty:"",unit:"g",dlc:""});(0,l.useEffect)(()=>{(async()=>{let{data:e}=await a.OQ.from("locations").select("*").order("sort_order");t(e||[]);let{data:n}=await a.OQ.from("products_catalog").select("id,name,default_unit").order("name");o(n||[])})()},[]);let u=async e=>{if(e.preventDefault(),!r.product_id||!r.location_id||!r.qty)return alert("Remplis produit, lieu, quantit\xe9.");let{error:t}=await a.OQ.from("inventory_lots").insert({product_id:r.product_id,location_id:r.location_id,qty:Number(r.qty),unit:r.unit,dlc:r.dlc||null,source:"achat"});t?alert(t.message):(alert("Ajout\xe9 ✅"),s(e=>({...e,qty:"",dlc:""})))};return(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{children:"Ajouter un lot"}),(0,i.jsxs)("form",{onSubmit:u,className:"card",style:{display:"grid",gap:8,maxWidth:460},children:[(0,i.jsxs)("label",{children:["Produit",(0,i.jsxs)("select",{value:r.product_id,onChange:e=>{let t=e.target.value,i=n.find(e=>e.id===t);s(e=>({...e,product_id:t,unit:(null==i?void 0:i.default_unit)||e.unit}))},children:[(0,i.jsx)("option",{value:"",children:"— choisir —"}),n.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,i.jsxs)("label",{children:["Lieu",(0,i.jsxs)("select",{value:r.location_id,onChange:e=>s(t=>({...t,location_id:e.target.value})),children:[(0,i.jsx)("option",{value:"",children:"— choisir —"}),e.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,i.jsxs)("label",{children:["Quantit\xe9",(0,i.jsx)("input",{type:"number",step:"0.01",value:r.qty,onChange:e=>s(t=>({...t,qty:e.target.value}))})]}),(0,i.jsxs)("label",{children:["Unit\xe9",(0,i.jsx)("input",{value:r.unit,onChange:e=>s(t=>({...t,unit:e.target.value}))})]}),(0,i.jsxs)("label",{children:["DLC (optionnel)",(0,i.jsx)("input",{type:"date",value:r.dlc,onChange:e=>s(t=>({...t,dlc:e.target.value}))})]}),(0,i.jsx)("button",{type:"submit",children:"Ajouter"})]}),(0,i.jsx)("p",{style:{marginTop:8,color:"#555"},children:"Astuce : ajoute d’abord 2-3 produits & lieux dans Supabase si les listes sont vides."})]})}},5626:function(e,t,n){"use strict";n.d(t,{OQ:function(){return o}});var i=n(6887);let l="https://yylkwfikfbottngglaxj.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl5bGt3ZmlrZmJvdHRuZ2dsYXhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY1NjUwNzAsImV4cCI6MjA3MjE0MTA3MH0.h-GTmBH9onVHNJLLuafw9jwS9G8azVaQGelf-oUK-xc",o=null;if(l&&a)try{console.log("\uD83D\uDD17 Connexion \xe0 Supabase r\xe9el:",l),o=(0,i.eI)(l,a,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})}catch(e){console.error("[Supabase] Erreur lors de la cr\xe9ation du client",e instanceof Error?e:Error(String(e)))}else{let e=[!l&&"NEXT_PUBLIC_SUPABASE_URL",!a&&"NEXT_PUBLIC_SUPABASE_ANON_KEY"].filter(Boolean);Error("Supabase non configur\xe9. Variables manquantes: ".concat(e.join(", ")))}}},function(e){e.O(0,[887,971,23,744],function(){return e(e.s=1426)}),_N_E=e.O()}]);