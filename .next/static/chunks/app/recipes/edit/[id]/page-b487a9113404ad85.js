(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[418],{6410:function(e,t,n){Promise.resolve().then(n.bind(n,6097))},6097:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var i=n(7437),a=n(2265),s=n(6463),r=n(4392),l=n(7138);function o(){var e,t,n,o,c,u,m,d,p;let g=(0,s.useRouter)(),h=(0,s.useParams)(),x="new"===h.id,v=x?null:h.id,j=(0,r.createClientComponentClient)(),[f,y]=(0,a.useState)(!x),[N,b]=(0,a.useState)(!1),[_,C]=(0,a.useState)("basic"),[U,k]=(0,a.useState)({title:"",description:"",category:"",difficulty:"moyen",servings:4,prep_min:15,cook_min:30,total_min:45,is_veg:!1,is_divisible:!0,tags:[],image_url:"",source_canonical_url:"",author:"",nutrition:{macros:{calories:"",proteins:"",carbs:"",fats:""},micros:{}}}),[A,w]=(0,a.useState)([]),[D,S]=(0,a.useState)({qty:"",unit:"g",name:"",note:"",is_optional:!1}),[V,q]=(0,a.useState)([]),[E,O]=(0,a.useState)(!1),[I,P]=(0,a.useState)(""),[M,F]=(0,a.useState)([]),[B,R]=(0,a.useState)({utensil_name:"",quantity:1,is_optional:!1,notes:""}),[L,T]=(0,a.useState)([]),[z,Q]=(0,a.useState)(!1),[G,H]=(0,a.useState)(""),[J,K]=(0,a.useState)(""),[Z,W]=(0,a.useState)("mg"),[X,Y]=(0,a.useState)(!1),$=[{name:"Vitamine A",defaultUnit:"\xb5g",category:"Vitamines"},{name:"Vitamine D",defaultUnit:"\xb5g",category:"Vitamines"},{name:"Vitamine E",defaultUnit:"mg",category:"Vitamines"},{name:"Vitamine K",defaultUnit:"\xb5g",category:"Vitamines"},{name:"Vitamine C",defaultUnit:"mg",category:"Vitamines"},{name:"Vitamine B1 (Thiamine)",defaultUnit:"mg",category:"Vitamines"},{name:"Vitamine B2 (Riboflavine)",defaultUnit:"mg",category:"Vitamines"},{name:"Vitamine B3 (Niacine)",defaultUnit:"mg",category:"Vitamines"},{name:"Vitamine B5 (Acide pantoth\xe9nique)",defaultUnit:"mg",category:"Vitamines"},{name:"Vitamine B6",defaultUnit:"mg",category:"Vitamines"},{name:"Vitamine B9 (Folate)",defaultUnit:"\xb5g",category:"Vitamines"},{name:"Vitamine B12",defaultUnit:"\xb5g",category:"Vitamines"},{name:"Biotine (B8)",defaultUnit:"\xb5g",category:"Vitamines"},{name:"Calcium",defaultUnit:"mg",category:"Min\xe9raux"},{name:"Phosphore",defaultUnit:"mg",category:"Min\xe9raux"},{name:"Magn\xe9sium",defaultUnit:"mg",category:"Min\xe9raux"},{name:"Sodium",defaultUnit:"mg",category:"Min\xe9raux"},{name:"Potassium",defaultUnit:"mg",category:"Min\xe9raux"},{name:"Chlorure",defaultUnit:"mg",category:"Min\xe9raux"},{name:"Fer",defaultUnit:"mg",category:"Oligo-\xe9l\xe9ments"},{name:"Zinc",defaultUnit:"mg",category:"Oligo-\xe9l\xe9ments"},{name:"Cuivre",defaultUnit:"mg",category:"Oligo-\xe9l\xe9ments"},{name:"Mangan\xe8se",defaultUnit:"mg",category:"Oligo-\xe9l\xe9ments"},{name:"S\xe9l\xe9nium",defaultUnit:"\xb5g",category:"Oligo-\xe9l\xe9ments"},{name:"Iode",defaultUnit:"\xb5g",category:"Oligo-\xe9l\xe9ments"},{name:"Chrome",defaultUnit:"\xb5g",category:"Oligo-\xe9l\xe9ments"},{name:"Molybd\xe8ne",defaultUnit:"\xb5g",category:"Oligo-\xe9l\xe9ments"},{name:"Fibres alimentaires",defaultUnit:"g",category:"Autres"},{name:"Fibres solubles",defaultUnit:"g",category:"Autres"},{name:"Fibres insolubles",defaultUnit:"g",category:"Autres"},{name:"Sucres totaux",defaultUnit:"g",category:"Autres"},{name:"Sucres ajout\xe9s",defaultUnit:"g",category:"Autres"},{name:"Amidon",defaultUnit:"g",category:"Autres"},{name:"Cholest\xe9rol",defaultUnit:"mg",category:"Autres"},{name:"Acides gras satur\xe9s",defaultUnit:"g",category:"Acides gras"},{name:"Acides gras monoinsatur\xe9s",defaultUnit:"g",category:"Acides gras"},{name:"Acides gras polyinsatur\xe9s",defaultUnit:"g",category:"Acides gras"},{name:"Acides gras trans",defaultUnit:"g",category:"Acides gras"},{name:"Om\xe9ga 3 (EPA+DHA)",defaultUnit:"mg",category:"Acides gras"},{name:"Om\xe9ga 6",defaultUnit:"mg",category:"Acides gras"},{name:"Om\xe9ga 9",defaultUnit:"mg",category:"Acides gras"},{name:"Polyph\xe9nols",defaultUnit:"mg",category:"Antioxydants"},{name:"Flavono\xefdes",defaultUnit:"mg",category:"Antioxydants"},{name:"Carot\xe9no\xefdes",defaultUnit:"\xb5g",category:"Antioxydants"},{name:"Lycop\xe8ne",defaultUnit:"mg",category:"Antioxydants"},{name:"B\xeata-carot\xe8ne",defaultUnit:"\xb5g",category:"Antioxydants"},{name:"Lut\xe9ine",defaultUnit:"\xb5g",category:"Antioxydants"},{name:"Resv\xe9ratrol",defaultUnit:"mg",category:"Antioxydants"},{name:"Coenzyme Q10",defaultUnit:"mg",category:"Antioxydants"}];async function ee(){try{let{data:e,error:t}=await j.from("recipes").select("*").eq("id",v).single();if(t)throw t;let{data:n}=await j.from("recipe_ingredients_detailed").select("*").eq("recipe_id",v).order("position"),{data:i}=await j.from("recipe_steps").select("*").eq("recipe_id",v).order("step_no"),{data:a}=await j.from("recipe_utensils").select("*").eq("recipe_id",v),s=e.nutrition||{macros:{},micros:{}};if(s&&!s.macros&&!s.micros){let e={...s};s={macros:{calories:e.calories||"",proteins:e.proteins||"",carbs:e.carbs||"",fats:e.fats||""},micros:{}},Object.keys(e).forEach(t=>{["calories","proteins","carbs","fats"].includes(t)||(s.micros[t]={value:e[t],unit:"fibers"===t?"g":"mg"})})}k({...e,tags:e.tags||[],nutrition:s}),e.steps&&(!i||0===i.length)?(O(!0),P(e.steps)):q(i||[]),w(n||[]),F(a||[])}catch(e){console.error("Erreur chargement recette:",e),alert("Erreur lors du chargement de la recette")}finally{y(!1)}}async function et(e){if(!e||e.length<2){T([]);return}Q(!0);try{let{data:t}=await j.from("canonical_foods").select("id, canonical_name, category_id").ilike("canonical_name","%".concat(e,"%")).limit(5),{data:n}=await j.from("generic_products").select("id, name, category_id").ilike("name","%".concat(e,"%")).limit(5),i=[...(t||[]).map(e=>({id:e.id,name:e.canonical_name,type:"canonical",category_id:e.category_id})),...(n||[]).map(e=>({id:e.id,name:e.name,type:"generic",category_id:e.category_id}))];T(i)}catch(e){console.error("Erreur recherche produits:",e)}finally{Q(!1)}}function en(e,t,n){let i=[...V];i[e][t]=n,q(i)}async function ei(){if(!U.title){alert("Le titre est obligatoire");return}b(!0);try{let e=v,t=null;if(U.nutrition){let e={},n={};U.nutrition.macros&&Object.entries(U.nutrition.macros).forEach(t=>{let[n,i]=t;i&&""!==i&&(e[n]=i)}),U.nutrition.micros&&Object.entries(U.nutrition.micros).forEach(e=>{let[t,i]=e;i&&i.value&&""!==i.value&&(n[t]=i)}),(Object.keys(e).length>0||Object.keys(n).length>0)&&(t={macros:e,micros:n})}let n={...U,steps:E?I:null,tags:U.tags.length>0?U.tags:null,nutrition:t};if(x){let{data:t,error:i}=await j.from("recipes").insert([n]).select().single();if(i)throw i;e=t.id}else{let{error:e}=await j.from("recipes").update(n).eq("id",v);if(e)throw e}if(x||(await j.from("recipe_ingredients").delete().eq("recipe_id",e),await j.from("recipe_steps").delete().eq("recipe_id",e),await j.from("recipe_utensils").delete().eq("recipe_id",e)),A.length>0){let t=A.map((t,n)=>({recipe_id:e,qty:parseFloat(t.qty),unit:t.unit,note:t.note||null,is_optional:t.is_optional||!1,position:n,product_id:t.product_id||null})),{error:n}=await j.from("recipe_ingredients").insert(t);if(n)throw n}if(!E&&V.length>0){let t=V.map((t,n)=>({recipe_id:e,step_no:n+1,instruction:t.instruction,duration_min:t.duration_min?parseInt(t.duration_min):null,temperature:t.temperature?parseInt(t.temperature):null,temperature_unit:t.temperature_unit||"\xb0C"})),{error:n}=await j.from("recipe_steps").insert(t);if(n)throw n}if(M.length>0){let t=M.map(t=>({recipe_id:e,utensil_name:t.utensil_name,quantity:parseInt(t.quantity)||1,is_optional:t.is_optional||!1,notes:t.notes||null})),{error:n}=await j.from("recipe_utensils").insert(t);if(n)throw n}alert("Recette sauvegard\xe9e avec succ\xe8s!"),g.push("/recipes")}catch(e){console.error("Erreur sauvegarde:",e),alert("Erreur lors de la sauvegarde: "+e.message)}finally{b(!1)}}return(0,a.useEffect)(()=>{!x&&v&&ee()},[v]),(0,a.useEffect)(()=>{let e=(parseInt(U.prep_min)||0)+(parseInt(U.cook_min)||0);k(t=>({...t,total_min:e}))},[U.prep_min,U.cook_min]),(0,a.useEffect)(()=>{function e(e){!X||e.target.closest(".micro-suggestions-dropdown")||e.target.closest(".form-group")||Y(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[X]),f?(0,i.jsx)("div",{className:"recipes-container",children:(0,i.jsx)("div",{className:"loading-spinner",children:"⏳ Chargement..."})}):(0,i.jsxs)("div",{className:"recipes-container",children:[(0,i.jsxs)("div",{className:"recipes-header",children:[(0,i.jsx)("h1",{children:x?"➕ Nouvelle recette":"✏️ Modifier la recette"}),(0,i.jsx)(l.default,{href:"/recipes",className:"btn-secondary",children:"← Retour aux recettes"})]}),(0,i.jsxs)("div",{className:"edit-tabs",children:[(0,i.jsx)("button",{className:"tab-btn ".concat("basic"===_?"active":""),onClick:()=>C("basic"),children:"\uD83D\uDCDD Informations"}),(0,i.jsx)("button",{className:"tab-btn ".concat("ingredients"===_?"active":""),onClick:()=>C("ingredients"),children:"\uD83E\uDD55 Ingr\xe9dients"}),(0,i.jsx)("button",{className:"tab-btn ".concat("steps"===_?"active":""),onClick:()=>C("steps"),children:"\uD83D\uDCCB Instructions"}),(0,i.jsx)("button",{className:"tab-btn ".concat("tools"===_?"active":""),onClick:()=>C("tools"),children:"\uD83D\uDD27 Ustensiles"}),(0,i.jsx)("button",{className:"tab-btn ".concat("nutrition"===_?"active":""),onClick:()=>C("nutrition"),children:"\uD83D\uDCCA Nutrition"})]}),(0,i.jsxs)("div",{className:"edit-content",children:["basic"===_&&(0,i.jsxs)("div",{className:"edit-section",children:[(0,i.jsx)("h2",{children:"Informations de base"}),(0,i.jsxs)("div",{className:"form-grid",children:[(0,i.jsxs)("div",{className:"form-group full-width",children:[(0,i.jsx)("label",{children:"Titre de la recette *"}),(0,i.jsx)("input",{type:"text",value:U.title,onChange:e=>k({...U,title:e.target.value}),placeholder:"Ex: Tarte aux pommes maison",className:"form-input"})]}),(0,i.jsxs)("div",{className:"form-group full-width",children:[(0,i.jsx)("label",{children:"Description"}),(0,i.jsx)("textarea",{value:U.description,onChange:e=>k({...U,description:e.target.value}),placeholder:"Une d\xe9licieuse tarte aux pommes avec une p\xe2te croustillante...",className:"form-textarea",rows:"3"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Cat\xe9gorie"}),(0,i.jsxs)("select",{value:U.category,onChange:e=>k({...U,category:e.target.value}),className:"form-select",children:[(0,i.jsx)("option",{value:"",children:"-- S\xe9lectionner --"}),(0,i.jsx)("option",{value:"entr\xe9e",children:"Entr\xe9e"}),(0,i.jsx)("option",{value:"plat",children:"Plat principal"}),(0,i.jsx)("option",{value:"dessert",children:"Dessert"}),(0,i.jsx)("option",{value:"collation",children:"Collation"}),(0,i.jsx)("option",{value:"boisson",children:"Boisson"}),(0,i.jsx)("option",{value:"sauce",children:"Sauce"}),(0,i.jsx)("option",{value:"accompagnement",children:"Accompagnement"})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Difficult\xe9"}),(0,i.jsxs)("select",{value:U.difficulty,onChange:e=>k({...U,difficulty:e.target.value}),className:"form-select",children:[(0,i.jsx)("option",{value:"facile",children:"Facile"}),(0,i.jsx)("option",{value:"moyen",children:"Moyen"}),(0,i.jsx)("option",{value:"difficile",children:"Difficile"})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Nombre de portions"}),(0,i.jsx)("input",{type:"number",value:U.servings,onChange:e=>k({...U,servings:parseInt(e.target.value)||0}),min:"1",className:"form-input"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Temps de pr\xe9paration (min)"}),(0,i.jsx)("input",{type:"number",value:U.prep_min,onChange:e=>k({...U,prep_min:parseInt(e.target.value)||0}),min:"0",className:"form-input"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Temps de cuisson (min)"}),(0,i.jsx)("input",{type:"number",value:U.cook_min,onChange:e=>k({...U,cook_min:parseInt(e.target.value)||0}),min:"0",className:"form-input"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Temps total (min)"}),(0,i.jsx)("input",{type:"number",value:U.total_min,readOnly:!0,className:"form-input readonly"})]}),(0,i.jsxs)("div",{className:"form-group full-width",children:[(0,i.jsx)("label",{children:"URL de l\\'image"}),(0,i.jsx)("input",{type:"url",value:U.image_url,onChange:e=>k({...U,image_url:e.target.value}),placeholder:"https://...",className:"form-input"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Source/URL originale"}),(0,i.jsx)("input",{type:"url",value:U.source_canonical_url,onChange:e=>k({...U,source_canonical_url:e.target.value}),placeholder:"https://...",className:"form-input"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Auteur"}),(0,i.jsx)("input",{type:"text",value:U.author,onChange:e=>k({...U,author:e.target.value}),placeholder:"Nom de l\\'auteur",className:"form-input"})]}),(0,i.jsxs)("div",{className:"form-group full-width",children:[(0,i.jsx)("label",{children:"Tags (s\xe9par\xe9s par des virgules)"}),(0,i.jsx)("input",{type:"text",value:U.tags.join(", "),onChange:e=>k({...U,tags:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)}),placeholder:"Ex: rapide, sans gluten, \xe9t\xe9",className:"form-input"})]}),(0,i.jsx)("div",{className:"form-group checkbox-group",children:(0,i.jsxs)("label",{className:"checkbox-label",children:[(0,i.jsx)("input",{type:"checkbox",checked:U.is_veg,onChange:e=>k({...U,is_veg:e.target.checked})}),(0,i.jsx)("span",{children:"\uD83C\uDF31 V\xe9g\xe9tarien"})]})}),(0,i.jsx)("div",{className:"form-group checkbox-group",children:(0,i.jsxs)("label",{className:"checkbox-label",children:[(0,i.jsx)("input",{type:"checkbox",checked:U.is_divisible,onChange:e=>k({...U,is_divisible:e.target.checked})}),(0,i.jsx)("span",{children:"Recette divisible"})]})})]})]}),"ingredients"===_&&(0,i.jsxs)("div",{className:"edit-section",children:[(0,i.jsx)("h2",{children:"Ingr\xe9dients"}),A.length>0&&(0,i.jsx)("div",{className:"ingredients-list-edit",children:A.map((e,t)=>(0,i.jsxs)("div",{className:"ingredient-item-edit",children:[(0,i.jsx)("span",{className:"ingredient-position",children:t+1}),(0,i.jsxs)("span",{className:"ingredient-qty",children:[e.qty," ",e.unit]}),(0,i.jsxs)("span",{className:"ingredient-name",children:[e.display_name||e.name,e.is_optional&&" (optionnel)"]}),e.note&&(0,i.jsx)("span",{className:"ingredient-note",children:e.note}),(0,i.jsx)("button",{onClick:()=>{w(A.filter((e,n)=>n!==t))},className:"btn-remove",title:"Supprimer",children:"✕"})]},e.id||t))}),(0,i.jsxs)("div",{className:"add-ingredient-form",children:[(0,i.jsx)("h3",{children:"Ajouter un ingr\xe9dient"}),(0,i.jsxs)("div",{className:"form-grid",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Quantit\xe9 *"}),(0,i.jsx)("input",{type:"number",value:D.qty,onChange:e=>S({...D,qty:e.target.value}),placeholder:"100",className:"form-input",step:"0.01"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Unit\xe9"}),(0,i.jsxs)("select",{value:D.unit,onChange:e=>S({...D,unit:e.target.value}),className:"form-select",children:[(0,i.jsx)("option",{value:"g",children:"g"}),(0,i.jsx)("option",{value:"kg",children:"kg"}),(0,i.jsx)("option",{value:"ml",children:"ml"}),(0,i.jsx)("option",{value:"l",children:"l"}),(0,i.jsx)("option",{value:"u",children:"unit\xe9(s)"}),(0,i.jsx)("option",{value:"cs",children:"c.\xe0.s"}),(0,i.jsx)("option",{value:"cc",children:"c.\xe0.c"}),(0,i.jsx)("option",{value:"pinc\xe9e",children:"pinc\xe9e"})]})]}),(0,i.jsxs)("div",{className:"form-group span-2",children:[(0,i.jsx)("label",{children:"Nom de l\\'ingr\xe9dient *"}),(0,i.jsx)("input",{type:"text",value:D.name,onChange:e=>{S({...D,name:e.target.value}),et(e.target.value)},placeholder:"Ex: Tomates cerises",className:"form-input"}),z&&(0,i.jsx)("span",{className:"searching",children:"Recherche..."}),L.length>0&&(0,i.jsx)("div",{className:"suggestions-dropdown",children:L.map(e=>(0,i.jsxs)("div",{className:"suggestion-item",onClick:()=>{S({...D,name:e.name}),T([])},children:[e.name,(0,i.jsx)("span",{className:"suggestion-type",children:e.type})]},"".concat(e.type,"-").concat(e.id)))})]}),(0,i.jsxs)("div",{className:"form-group span-2",children:[(0,i.jsx)("label",{children:"Note (optionnel)"}),(0,i.jsx)("input",{type:"text",value:D.note,onChange:e=>S({...D,note:e.target.value}),placeholder:"Ex: coup\xe9es en deux",className:"form-input"})]}),(0,i.jsx)("div",{className:"form-group checkbox-group",children:(0,i.jsxs)("label",{className:"checkbox-label",children:[(0,i.jsx)("input",{type:"checkbox",checked:D.is_optional,onChange:e=>S({...D,is_optional:e.target.checked})}),(0,i.jsx)("span",{children:"Optionnel"})]})}),(0,i.jsx)("div",{className:"form-group",children:(0,i.jsx)("button",{onClick:function(){if(!D.name||!D.qty){alert("Veuillez remplir au moins le nom et la quantit\xe9");return}w([...A,{...D,id:"new-".concat(Date.now()),position:A.length}]),S({qty:"",unit:"g",name:"",note:"",is_optional:!1})},className:"btn-primary",type:"button",children:"➕ Ajouter"})})]})]})]}),"steps"===_&&(0,i.jsxs)("div",{className:"edit-section",children:[(0,i.jsx)("h2",{children:"Instructions"}),(0,i.jsxs)("div",{className:"steps-mode-selector",children:[(0,i.jsxs)("label",{className:"radio-label",children:[(0,i.jsx)("input",{type:"radio",checked:E,onChange:()=>O(!0)}),(0,i.jsx)("span",{children:"Mode texte libre"})]}),(0,i.jsxs)("label",{className:"radio-label",children:[(0,i.jsx)("input",{type:"radio",checked:!E,onChange:()=>O(!1)}),(0,i.jsx)("span",{children:"Mode \xe9tapes structur\xe9es"})]})]}),E?(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Instructions (texte libre)"}),(0,i.jsx)("textarea",{value:I,onChange:e=>P(e.target.value),placeholder:"D\xe9crivez les \xe9tapes de pr\xe9paration...",className:"form-textarea",rows:"10"})]}):(0,i.jsxs)(i.Fragment,{children:[V.map((e,t)=>(0,i.jsxs)("div",{className:"step-item-edit",children:[(0,i.jsxs)("div",{className:"step-header",children:[(0,i.jsxs)("span",{className:"step-number",children:["\xc9tape ",t+1]}),(0,i.jsx)("button",{onClick:()=>{q(V.filter((e,n)=>n!==t))},className:"btn-remove",title:"Supprimer cette \xe9tape",children:"✕"})]}),(0,i.jsxs)("div",{className:"form-grid",children:[(0,i.jsxs)("div",{className:"form-group full-width",children:[(0,i.jsx)("label",{children:"Instruction"}),(0,i.jsx)("textarea",{value:e.instruction,onChange:e=>en(t,"instruction",e.target.value),placeholder:"D\xe9crivez cette \xe9tape...",className:"form-textarea",rows:"2"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Dur\xe9e (min)"}),(0,i.jsx)("input",{type:"number",value:e.duration_min||"",onChange:e=>en(t,"duration_min",e.target.value),placeholder:"10",className:"form-input",min:"0"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Temp\xe9rature"}),(0,i.jsx)("input",{type:"number",value:e.temperature||"",onChange:e=>en(t,"temperature",e.target.value),placeholder:"180",className:"form-input"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Unit\xe9 temp."}),(0,i.jsxs)("select",{value:e.temperature_unit||"\xb0C",onChange:e=>en(t,"temperature_unit",e.target.value),className:"form-select",children:[(0,i.jsx)("option",{value:"\xb0C",children:"\xb0C"}),(0,i.jsx)("option",{value:"\xb0F",children:"\xb0F"})]})]})]})]},e.id||t)),(0,i.jsx)("button",{onClick:function(){let e={id:"new-".concat(Date.now()),step_no:V.length+1,instruction:"",duration_min:null,temperature:null,temperature_unit:"\xb0C"};q([...V,e])},className:"btn-secondary",type:"button",children:"➕ Ajouter une \xe9tape"})]})]}),"tools"===_&&(0,i.jsxs)("div",{className:"edit-section",children:[(0,i.jsx)("h2",{children:"Ustensiles"}),M.length>0&&(0,i.jsx)("div",{className:"utensils-list-edit",children:M.map((e,t)=>(0,i.jsxs)("div",{className:"utensil-item-edit",children:[(0,i.jsx)("span",{className:"utensil-qty",children:e.quantity>1&&"".concat(e.quantity,"\xd7 ")}),(0,i.jsxs)("span",{className:"utensil-name",children:[e.utensil_name,e.is_optional&&" (optionnel)"]}),e.notes&&(0,i.jsx)("span",{className:"utensil-note",children:e.notes}),(0,i.jsx)("button",{onClick:()=>{F(M.filter((e,n)=>n!==t))},className:"btn-remove",title:"Supprimer",children:"✕"})]},e.id||t))}),(0,i.jsxs)("div",{className:"add-utensil-form",children:[(0,i.jsx)("h3",{children:"Ajouter un ustensile"}),(0,i.jsxs)("div",{className:"form-grid",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Nom de l\\'ustensile *"}),(0,i.jsx)("input",{type:"text",value:B.utensil_name,onChange:e=>R({...B,utensil_name:e.target.value}),placeholder:"Ex: Po\xeale",className:"form-input"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Quantit\xe9"}),(0,i.jsx)("input",{type:"number",value:B.quantity,onChange:e=>R({...B,quantity:e.target.value}),min:"1",className:"form-input"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Notes"}),(0,i.jsx)("input",{type:"text",value:B.notes,onChange:e=>R({...B,notes:e.target.value}),placeholder:"Ex: 28 cm de diam\xe8tre",className:"form-input"})]}),(0,i.jsx)("div",{className:"form-group checkbox-group",children:(0,i.jsxs)("label",{className:"checkbox-label",children:[(0,i.jsx)("input",{type:"checkbox",checked:B.is_optional,onChange:e=>R({...B,is_optional:e.target.checked})}),(0,i.jsx)("span",{children:"Optionnel"})]})}),(0,i.jsx)("div",{className:"form-group",children:(0,i.jsx)("button",{onClick:function(){if(!B.utensil_name){alert("Veuillez entrer le nom de l'ustensile");return}F([...M,{...B,id:"new-".concat(Date.now())}]),R({utensil_name:"",quantity:1,is_optional:!1,notes:""})},className:"btn-primary",type:"button",children:"➕ Ajouter"})})]})]})]}),"nutrition"===_&&(0,i.jsxs)("div",{className:"edit-section",children:[(0,i.jsx)("h2",{children:"Informations nutritionnelles"}),(0,i.jsx)("p",{className:"info-text",children:"Les informations nutritionnelles peuvent \xeatre calcul\xe9es automatiquement \xe0 partir des ingr\xe9dients ou saisies manuellement. Toutes les valeurs sont par portion."}),(0,i.jsxs)("div",{className:"nutrition-section",children:[(0,i.jsx)("h3",{children:"Macronutriments (par portion)"}),(0,i.jsxs)("div",{className:"form-grid",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Calories (kcal)"}),(0,i.jsx)("input",{type:"number",value:(null===(t=U.nutrition)||void 0===t?void 0:null===(e=t.macros)||void 0===e?void 0:e.calories)||"",onChange:e=>{var t;return k({...U,nutrition:{...U.nutrition,macros:{...null===(t=U.nutrition)||void 0===t?void 0:t.macros,calories:e.target.value}}})},className:"form-input"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Prot\xe9ines (g)"}),(0,i.jsx)("input",{type:"number",value:(null===(o=U.nutrition)||void 0===o?void 0:null===(n=o.macros)||void 0===n?void 0:n.proteins)||"",onChange:e=>{var t;return k({...U,nutrition:{...U.nutrition,macros:{...null===(t=U.nutrition)||void 0===t?void 0:t.macros,proteins:e.target.value}}})},className:"form-input",step:"0.1"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Glucides (g)"}),(0,i.jsx)("input",{type:"number",value:(null===(u=U.nutrition)||void 0===u?void 0:null===(c=u.macros)||void 0===c?void 0:c.carbs)||"",onChange:e=>{var t;return k({...U,nutrition:{...U.nutrition,macros:{...null===(t=U.nutrition)||void 0===t?void 0:t.macros,carbs:e.target.value}}})},className:"form-input",step:"0.1"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Lipides (g)"}),(0,i.jsx)("input",{type:"number",value:(null===(d=U.nutrition)||void 0===d?void 0:null===(m=d.macros)||void 0===m?void 0:m.fats)||"",onChange:e=>{var t;return k({...U,nutrition:{...U.nutrition,macros:{...null===(t=U.nutrition)||void 0===t?void 0:t.macros,fats:e.target.value}}})},className:"form-input",step:"0.1"})]})]})]}),(0,i.jsxs)("div",{className:"nutrition-section",children:[(0,i.jsx)("h3",{children:"Micronutriments (par portion)"}),(null===(p=U.nutrition)||void 0===p?void 0:p.micros)&&Object.keys(U.nutrition.micros).length>0&&(0,i.jsx)("div",{className:"micros-list",children:Object.entries(U.nutrition.micros).map(e=>{let[t,n]=e;return(0,i.jsxs)("div",{className:"micro-item",children:[(0,i.jsx)("span",{className:"micro-name",children:t}),(0,i.jsxs)("span",{className:"micro-value",children:[n.value," ",n.unit]}),(0,i.jsx)("button",{type:"button",onClick:()=>(function(e){let t={...U.nutrition};t.micros&&delete t.micros[e],k({...U,nutrition:t})})(t),className:"btn-remove-micro",title:"Supprimer",children:"✕"})]},t)})}),(0,i.jsxs)("div",{className:"add-micro-form",children:[(0,i.jsx)("h4",{children:"Ajouter un micronutriment"}),(0,i.jsxs)("div",{className:"form-grid",children:[(0,i.jsxs)("div",{className:"form-group span-2",style:{position:"relative"},children:[(0,i.jsx)("label",{children:"Nom du nutriment"}),(0,i.jsx)("input",{type:"text",value:G,onChange:e=>{H(e.target.value),Y(!0)},onFocus:()=>Y(!0),placeholder:"Ex: Vitamine C, Fer, Calcium...",className:"form-input"}),X&&(0,i.jsxs)("div",{className:"micro-suggestions-dropdown",children:[(0,i.jsxs)("div",{className:"suggestions-header",children:[(0,i.jsx)("small",{children:"Suggestions courantes (cliquez pour s\xe9lectionner)"}),(0,i.jsx)("button",{type:"button",onClick:()=>Y(!1),className:"close-suggestions",children:"✕"})]}),(0,i.jsx)("div",{className:"suggestions-content",children:["Vitamines","Min\xe9raux","Oligo-\xe9l\xe9ments","Acides gras","Antioxydants","Autres"].map(e=>{let t=$.filter(t=>t.category===e).filter(e=>!G||e.name.toLowerCase().includes(G.toLowerCase())).filter(e=>{var t;return!(null===(t=U.nutrition)||void 0===t?void 0:t.micros)||!U.nutrition.micros[e.name]});return 0===t.length?null:(0,i.jsxs)("div",{className:"suggestion-category",children:[(0,i.jsx)("div",{className:"category-header",children:e}),(0,i.jsx)("div",{className:"suggestions-grid",children:t.map(e=>(0,i.jsxs)("button",{type:"button",className:"micro-suggestion-btn",onClick:()=>{H(e.name),W(e.defaultUnit),Y(!1)},children:[(0,i.jsx)("span",{className:"suggestion-name",children:e.name}),(0,i.jsx)("span",{className:"suggestion-unit",children:e.defaultUnit})]},e.name))})]},e)})})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Valeur"}),(0,i.jsx)("input",{type:"number",value:J,onChange:e=>K(e.target.value),placeholder:"0",className:"form-input",step:"0.01"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Unit\xe9"}),(0,i.jsxs)("select",{value:Z,onChange:e=>W(e.target.value),className:"form-select",children:[(0,i.jsx)("option",{value:"g",children:"g"}),(0,i.jsx)("option",{value:"mg",children:"mg"}),(0,i.jsx)("option",{value:"\xb5g",children:"\xb5g (mcg)"}),(0,i.jsx)("option",{value:"UI",children:"UI"}),(0,i.jsx)("option",{value:"%",children:"% AJR"})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"\xa0"}),(0,i.jsx)("button",{type:"button",onClick:function(){if(!G||!J){alert("Veuillez s\xe9lectionner un nutriment et entrer une valeur");return}let e={...U.nutrition};e.micros||(e.micros={}),e.micros[G]={value:parseFloat(J),unit:Z},k({...U,nutrition:e}),H(""),K(""),W("mg"),Y(!1)},className:"btn-primary",children:"➕ Ajouter"})]})]}),(0,i.jsx)("div",{className:"micro-info",children:(0,i.jsx)("small",{children:"\uD83D\uDCA1 Astuce : Vous pouvez ajouter n'importe quel nutriment ou compos\xe9 nutritionnel (vitamines, min\xe9raux, acides amin\xe9s, antioxydants, etc.)"})})]})]})]})]}),(0,i.jsxs)("div",{className:"edit-actions-bar",children:[(0,i.jsx)(l.default,{href:"/recipes",className:"btn-secondary",children:"✕ Annuler"}),(0,i.jsx)("button",{onClick:ei,disabled:N||!U.title,className:"btn-primary",children:N?"⏳ Sauvegarde...":"\uD83D\uDCBE Sauvegarder la recette"})]})]})}n(5213)},6463:function(e,t,n){"use strict";var i=n(1169);n.o(i,"useParams")&&n.d(t,{useParams:function(){return i.useParams}}),n.o(i,"usePathname")&&n.d(t,{usePathname:function(){return i.usePathname}}),n.o(i,"useRouter")&&n.d(t,{useRouter:function(){return i.useRouter}}),n.o(i,"useSearchParams")&&n.d(t,{useSearchParams:function(){return i.useSearchParams}})},5213:function(){}},function(e){e.O(0,[738,887,138,392,971,23,744],function(){return e(e.s=6410)}),_N_E=e.O()}]);